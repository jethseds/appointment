@{
    Layout = "_Layout";
}
@model DentistScheduleModel
@{
    var accountList = ViewData["AccountList"] as List<Appointment.Models.AccountModel>;

}
@{
    var servicesList = ViewData["ServicesList"] as List<Appointment.Models.ServicesModel>;

}

<link rel="stylesheet" href="https://cdn.datatables.net/2.2.1/css/dataTables.bootstrap5.css" />
<div class="wrapper">
    <div class="sidebar">
        <ul class="nav flex-column">
            <li class="nav-item mt-5 mb-5 text-center">
                <a class="nav-link text-secondary fw-semibold" href="#">
                    <img src="/images/logo.png" width="100px">
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link text-secondary fw-semibold" href="/Admin/Employees"><i class="fas fa-users"></i> Employees</a>
                <a class="nav-link text-secondary fw-semibold" href="/Admin/DentistSchedule"><i class="fas fa-calendar"></i> Dentist Schedule</a>
                <a class="nav-link text-secondary fw-semibold" href="/Admin/Services"><i class="fas fa-cog"></i> Services</a>
            </li>
        </ul>

        <!-- Logout at the bottom -->
        <ul class="nav flex-column mt-auto">
            <li class="nav-item">
                <a class="nav-link text-secondary fw-semibold" href="/Account/Login"><i class="fas fa-sign-out"></i> Logout</a>
            </li>
        </ul>
    </div>

    <div class="container-fluid bg-light" style="height: 100vh;">


        <form asp-action="AddDentistSchedule" method="POST">
            <input type="hidden" name="Id" value="@Model?.Id.ToString()" />


            <div class="row">
                <div class="col-lg-4 mt-3">
                    <div class="form-group has-feedback form-control" style="height: 45px;position: relative;">

                        <select name="services_id" id="ServicesId" style="width: 100%; height: 100%; border: unset; box-shadow: none; outline-style: none;" required>
                            @if (@Model?.Id != null)
                            {
                                // First render the option where the Id matches Model.UsersId
                                var selectedservices = servicesList.FirstOrDefault(a => a.Id.ToString() == Model.ServicesId);
                                if (selectedservices != null)
                                {
                                    <option value="@selectedservices.Id" selected>
                                        @selectedservices.Title
                                    </option>
                                }

                                // Render the rest of the options
                                foreach (var services in servicesList)
                                {
                                    if (services.Id.ToString() != Model.ServicesId)
                                    {
                                        <option value="@services.Id">
                                            @services.Title
                                        </option>
                                    }
                                }
                            }
                            else
                            {

                                foreach (var services in servicesList)
                                {
                                    <option value="@services.Id">@services.Title</option>
                                }
                            }
                        </select>


                    </div>
                </div>
                <div class="col-lg-4 mt-3">
                    <div class="form-group has-feedback form-control" style="height: 45px;position: relative;">

                        <select name="users_id" id="UsersId" style="width: 100%; height: 100%; border: unset; box-shadow: none; outline-style: none;" required>
                            @if (@Model?.Id != null)
                            {
                                // First render the option where the Id matches Model.UsersId
                                var selectedAccount = accountList.FirstOrDefault(a => a.Id.ToString() == Model.UsersId);
                                if (selectedAccount != null)
                                {
                                    <option value="@selectedAccount.Id" selected>
                                        @selectedAccount.FirstName @selectedAccount.LastName
                                    </option>
                                }

                                // Render the rest of the options
                                foreach (var account in accountList)
                                {
                                    if (account.Id.ToString() != Model.UsersId)
                                    {
                                        <option value="@account.Id">
                                            @account.FirstName @account.LastName
                                        </option>
                                    }
                                }
                            }
                            else
                            {

                                foreach (var account in accountList)
                                {
                                    <option value="@account.Id">@account.FirstName @account.LastName</option>
                                }
                            }
                        </select>


                    </div>
                </div>
                <div class="col-lg-4 mt-3">
                    <div class="form-group has-feedback form-control" style="height: 45px;position: relative;">
                        <input type="date" name="date_available" id="DateAvailable"
                               value="@(DateTime.TryParse(Model?.DateAvailable, out var date) ? date.ToString("yyyy-MM-dd") : "")"
                               style="width: 100%;height: 100%;border: unset;box-shadow: none;outline-style: none;" required>
                        <span class="fa fa-calendar form-control-feedback" style="top: 50%;transform: translateY(-50%);position:absolute;right: 10px;"></span>
                    </div>
                </div>
                <div class="col-lg-4 mt-3">
                    <div class="form-group has-feedback form-control" style="height: 45px;position: relative;">
                        <input type="time" name="start_time" id="StartTime" value="@Model?.StartTime" style="width: 100%;height: 100%;border: unset;box-shadow: none;outline-style: none;" required>
                        <span class="fa fa-clock form-control-feedback" style="top: 50%;transform: translateY(-50%);position:absolute;right: 10px;"></span>
                    </div>
                </div>
                <div class="col-lg-6 mt-3">
                    <div class="form-group has-feedback form-control" style="height: 45px;position: relative;">
                        <input type="time" name="end_time" id="EndTime" value="@Model?.EndTime" style="width: 100%;height: 100%;border: unset;box-shadow: none;outline-style: none;" required>
                        <span class="fa fa-clock form-control-feedback" style="top: 50%;transform: translateY(-50%);position:absolute;right: 10px;"></span>
                    </div>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-xs-12">
                    <button type="submit" class="btn btn-block btn-flat" style="background: #00bf63; color: #fff; border: unset;height: 45px;font-size: 23px;" name="register">Save</button>
                </div>
            </div>
        </form>
    </div>
</div>
